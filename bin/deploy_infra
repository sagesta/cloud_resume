#!/bin/bash
set -e

#
# Deploys the Bicep template to the resource group.
#
# USAGE
#   ./bin/deploy_infra <resource_group_name> <storage_account_name>
#
# ARGUMENTS
#   - resource_group_name: The name of the resource group to deploy to.
#   - storage_account_name: The name of the storage account to create.
#

# Check if the correct number of arguments were provided.
if [ "$#" -ne 2 ]; then
    echo "Usage: ./bin/deploy_infra <resource_group_name> <storage_account_name>"
    exit 1
fi

# Get the arguments.
resource_group_name=$1
storage_account_name=$2

# Deploy the Bicep template.
az deployment group create \
    --resource-group "$resource_group_name" \
    --template-file main.bicep \
    --parameters storageAccountName="$storage_account_name"
